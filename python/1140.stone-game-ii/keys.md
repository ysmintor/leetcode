本题需要使用递归记忆，或者可以称之为动态规则。使用的是自顶向下，并在搜索过程将没有处理过的给记录起来，避免重复计算。

dfs(i, M) 表示，当从第 i 堆石子开始拿，允许拿 M <= x <= 2 * M 时，在剩余石子中所能拿到的最大值

在每一轮决策时需要考虑到对手同样也会做出最优的决择，因此需要在每一轮都判断。当在每一轮的决择都是最优的决择时，整个决择便是符合需要的决择链。

![dfs 自顶向下](https://pic.leetcode-cn.com/60082c4d1e54920a0e2ff73783e60884c18007b166a568438298b11cccd3802a.png)

在上面的图上，蓝色块代表先手拿的状态，黄色块代表后手拿的状态。边上的权值代表拿了几堆石子（也就是 x），红色边代表当前层最优解，连续的红色路径就是答案。这个 dfs 的值其实是需要从底层去计算得出的。

参考链接里讲解得非常清楚，只不过我觉得是需要多跟着手动去跟这个过程，做几次才能有更加深入地感性认识。

参考链接：

https://leetcode-cn.com/problems/stone-game-ii/solution/ji-yi-hua-sou-suo-python3-by-smoon1989/